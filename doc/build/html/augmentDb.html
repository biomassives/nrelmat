<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>augmentDb.py &mdash; cidlada 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="cidlada 1.0.0 documentation" href="index.html" />
    <link rel="next" title="fillDbVasp.py" href="fillDbVasp.html" />
    <link rel="prev" title="Welcome to cidlada’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fillDbVasp.html" title="fillDbVasp.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to cidlada’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">cidlada 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-nrelmat.augmentDb">
<span id="augmentdb-py"></span><h1>augmentDb.py<a class="headerlink" href="#module-nrelmat.augmentDb" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="nrelmat.augmentDb.main">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">main</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.main" title="Permalink to this definition">¶</a></dt>
<dd><p>This program adds additional information to the model database table.
The following functions in this file fill the indicated columns
in the model table.  The columns must have been created previously
by the fillDbVasp.py function createTable.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="15%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Column</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>addChemforms</td>
<td>formula</td>
<td>Standard chemical formula: <tt class="docutils literal"><span class="pre">&quot;H2</span> <span class="pre">O&quot;</span></tt>.</td>
</tr>
<tr class="row-odd"><td>addChemForms</td>
<td>chemtext</td>
<td>Structured formula, easier for parsing.
Every token is surrounded by spaces, and
single occurance atoms have the explicit
&#8220;1&#8221; count:
<tt class="docutils literal"><span class="pre">&quot;</span> <span class="pre">H</span> <span class="pre">2</span> <span class="pre">O</span> <span class="pre">1</span> <span class="pre">&quot;</span></tt>.</td>
</tr>
<tr class="row-even"><td>addMinenergy</td>
<td>minenergyid</td>
<td>== mident having min energyperatom
for this formula and symgroupnum.</td>
</tr>
</tbody>
</table>
<p>Command line parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>-bugLev</strong></td>
<td>integer</td>
<td>Debug level.  Normally 0.</td>
</tr>
<tr class="row-odd"><td><strong>-inSpec</strong></td>
<td>string</td>
<td>JSON file containing DB parameters.  See below.</td>
</tr>
</tbody>
</table>
<p><strong>inSpec File Parameters:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>dbhost</strong></td>
<td>Database hostname.</td>
</tr>
<tr class="row-odd"><td><strong>dbport</strong></td>
<td>Database port number.</td>
</tr>
<tr class="row-even"><td><strong>dbuser</strong></td>
<td>Database user name.</td>
</tr>
<tr class="row-odd"><td><strong>dbpswd</strong></td>
<td>Database password.</td>
</tr>
<tr class="row-even"><td><strong>dbname</strong></td>
<td>Database database name.</td>
</tr>
<tr class="row-odd"><td><strong>dbschema</strong></td>
<td>Database schema name.</td>
</tr>
<tr class="row-even"><td><strong>dbtablemodel</strong></td>
<td>Database name of the &#8220;model&#8221; table.</td>
</tr>
<tr class="row-odd"><td><strong>dbtableicsd</strong></td>
<td>Database name of the &#8220;icsd&#8221; table.</td>
</tr>
</tbody>
</table>
<p><strong>inSpec file example:</strong>:</p>
<div class="highlight-python"><pre>{
  "dbhost"         : "scctest",
  "dbport"         : "6432",
  "dbuser"         : "x",
  "dbpswd"         : "x",
  "dbname"         : "cidlada",
  "dbschema"       : "satom",
  "dbtablemodel"   : "model"
  "dbtableicsd"    : "icsd"
}</pre>
</div>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.augmentDb">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">augmentDb</tt><big>(</big><em>bugLev</em>, <em>inSpec</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#augmentDb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.augmentDb" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds additional information to the model database table.</p>
<p>See documentation for the <a class="reference internal" href="#nrelmat.augmentDb.main" title="nrelmat.augmentDb.main"><tt class="xref py py-func docutils literal"><span class="pre">main()</span></tt></a> function.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p class="first">bugLev (int): Debug level.  Normally 0.</p>
</li>
<li><dl class="first docutils">
<dt>inSpec (str): Name of JSON file containing DB parameters.</dt>
<dd><p class="first last">See description at <a class="reference internal" href="#nrelmat.augmentDb.main" title="nrelmat.augmentDb.main"><tt class="xref py py-func docutils literal"><span class="pre">main()</span></tt></a>.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>None</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.getIcol">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">getIcol</tt><big>(</big><em>names</em>, <em>nm</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#getIcol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.getIcol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of nm in names.  Calls throwerr if not found.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>names (str[]): The list of strings.</li>
<li>nm (str): The query string.</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>ix(int): index of nm in names.</li>
</ul>
<p>Raises: Exception if nm not in names.</p>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.addMinenergy">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">addMinenergy</tt><big>(</big><em>bugLev</em>, <em>curCols</em>, <em>db_rows</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#addMinenergy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.addMinenergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the min energyperatom for each formula.</p>
<p>Appends an element to each row:</p>
<p>minenergyid == the mident of the row having the min energyperatom
for this formula.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p class="first">curCols (str[]): List of column names.</p>
</li>
<li><dl class="first docutils">
<dt>db_rows (str[][]): Database rows: [irow][icol].</dt>
<dd><p class="first last">We append one element to each row.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>newCols (str[]): list of new column names == [&#8216;minenergyid&#8217;].</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.addChemforms">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">addChemforms</tt><big>(</big><em>bugLev</em>, <em>curCols</em>, <em>db_rows</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#addChemforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.addChemforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the formula and chemtext fields.</p>
<p>Appends two elements to each row:</p>
<dl class="docutils">
<dt>formula:</dt>
<dd>chemical formula, determined from typenames and typenums,
and factoring by the greatest common divison.
Elements are in alphabetic order.
For example, <tt class="docutils literal"><span class="pre">'H2</span> <span class="pre">O'</span></tt>.</dd>
<dt>chemtext:</dt>
<dd>Same as the formula, but every token is surrounded
spaces and singletons have an explicit &#8216;1&#8217;,
for ease in parsing.
For example, <tt class="docutils literal"><span class="pre">'</span> <span class="pre">H</span> <span class="pre">2</span> <span class="pre">O</span> <span class="pre">1</span> <span class="pre">'</span></tt>.</dd>
</dl>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p class="first">curCols (str[]): List of column names.</p>
</li>
<li><dl class="first docutils">
<dt>db_rows (str[][]): Database rows: [irow][icol].</dt>
<dd><p class="first last">We append two elements to each row.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>newCols (str[]): list of new column names == [&#8216;formula&#8217;, &#8216;chemtext&#8217;]</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.dbQuery">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">dbQuery</tt><big>(</big><em>bugLev</em>, <em>conn</em>, <em>cursor</em>, <em>dbtablemodel</em>, <em>dbtableicsd</em>, <em>queryCols</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#dbQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.dbQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Issues a DB SQL query and returns the results.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>bugLev (int): Debug level.  Normally 0.</li>
<li>conn (psycopg2.connection): Open DB connection</li>
<li>cursor (psycopg2.cursor): Open DB cursor</li>
<li>dbtablemodel (str): Database name of the &#8220;model&#8221; table.</li>
<li>dbtableicsd (str): Database name of the &#8220;icsd&#8221; table.</li>
<li>queryCols (str[]): List of column names to be retrieved.</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>db_rows(str[][]): Database rows: [irow][icol].</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.dbUpdate">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">dbUpdate</tt><big>(</big><em>bugLev</em>, <em>conn</em>, <em>cursor</em>, <em>dbtablemodel</em>, <em>queryCols</em>, <em>curCols</em>, <em>db_rows</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#dbUpdate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.dbUpdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Issues a DB SQL update.</p>
<p>Updates every row for just the newly added columns,
which are curCols - queryCols.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>bugLev (int): Debug level.  Normally 0.</li>
<li>conn (psycopg2.connection): Open DB connection</li>
<li>cursor (psycopg2.cursor): Open DB cursor</li>
<li>dbtablemodel (str): Database name of the &#8220;model&#8221; table.</li>
<li>queryCols (str[]): List of original column names.</li>
<li>curCols (str[]): List of current column names == queryCols + new cols.</li>
<li>db_rows(str[][]): Database rows: [irow][icol].</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>None</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="nrelmat.augmentDb.throwerr">
<tt class="descclassname">nrelmat.augmentDb.</tt><tt class="descname">throwerr</tt><big>(</big><em>msg</em><big>)</big><a class="reference internal" href="_modules/nrelmat/augmentDb.html#throwerr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nrelmat.augmentDb.throwerr" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints an error message and raises Exception.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li>msg (str): Error message.</li>
</ul>
<p><strong>Returns</strong></p>
<ul class="simple">
<li>(Never returns)</li>
</ul>
<p><strong>Raises</strong></p>
<ul class="simple">
<li>Exception</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to cidlada&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fillDbVasp.html"
                        title="next chapter">fillDbVasp.py</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/augmentDb.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fillDbVasp.html" title="fillDbVasp.py"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to cidlada’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">cidlada 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, S. Sullivan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>